<!DOCTYPE html>
<html lang="en" data-theme="light">
  <head>
    <meta charset="utf-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1" />
    <meta name="theme-color" content="#6a3b2d" />
    <title>PƒÅli Lessons (LMS)</title>
    <link rel="manifest" href="/manifest.webmanifest" />
    <link rel="icon" href="/icons/icon-192.png" type="image/png" />
    <link rel="apple-touch-icon" href="/icons/icon-192.png" />
    <link rel="stylesheet" href="/css/styles.css" />
    <!-- Firebase SDKs (compat build for non-module browsers) -->
    <script src="https://www.gstatic.com/firebasejs/10.12.4/firebase-app-compat.js"></script>
    <script src="https://www.gstatic.com/firebasejs/10.12.4/firebase-firestore-compat.js"></script>
    <script src="https://www.gstatic.com/firebasejs/10.12.4/firebase-auth-compat.js"></script>
    <script src="https://www.gstatic.com/firebasejs/10.12.4/firebase-storage-compat.js"></script>
    <!-- EmailJS SDK -->
    <script
      src="https://cdn.jsdelivr.net/npm/@emailjs/browser@4/dist/email.min.js"
      defer
    ></script>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/html2canvas/1.4.1/html2canvas.min.js"></script>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/jspdf/2.5.1/jspdf.umd.min.js"></script>
    <script src="https://www.paypal.com/sdk/js?client-id=AVpfmQ8DyyatFaAGQ3Jg58XtUt_2cJDr1leqcc_JI8LvKIR2N5WB_yljqCOTTCtvK1hFJ7Q9X0ojXsEC&currency=USD"></script>
    <!-- add this BEFORE your app.js script -->
    <script src="https://cdn.jsdelivr.net/npm/dompurify@2.4.0/dist/purify.min.js"></script>
    <script src="https://cdn.jsdelivr.net/npm/jspdf@2.5.1/dist/jspdf.umd.min.js"></script>
  </head>
  <body>
    <!-- ‚úÖ Topbar -->
    <header id="topbar" class="topbar">
      <div class="topbar-inner">
        <!-- Left: brand/logo -->
        <a class="brand" href="#/">
          <img src="/img/plant.png" alt="Logo" class="logo" />
          <span class="brand-text">PƒÅli LMS</span>
        </a>

        <!-- Center: burger (mobile only) -->
        <button
          id="btnMenu"
          class="btn-icon burger"
          aria-label="Open menu"
          aria-expanded="false"
          aria-controls="navLinks"
        >
          ‚ò∞
        </button>

        <!-- Right: desktop nav / auth -->
        <nav class="nav-desktop" aria-label="Primary">
          <a class="nav-link" href="#/">Home</a>
          <a class="nav-link" href="#/courses">Courses</a>

          <!-- auth-only: login ·Äú·ÄØ·Äï·Ä∫·Äõ·ÄÑ·Ä∫·Äï·Ä≤ ·Äô·Äº·ÄÑ·Ä∫·Äô·Äö·Ä∫ -->
          <a class="nav-link auth-only" href="#/dashboard">Dashboard</a>
          <a class="nav-link" href="#/profile">Profile</a>

          <!-- admin-only -->
          <a class="nav-link admin-only" href="#/admin">Admin</a>
        </nav>

        <div class="auth-actions">
          <button id="btnLogin" class="btn small">Login</button>
          <button id="btnLogout" class="btn small ghost hidden">Logout</button>
        </div>
      </div>
    </header>

    <!-- Topbar inside header/topbar -->
    <form id="searchForm" class="nav-search" role="search">
      <input
        id="searchInput"
        type="search"
        placeholder="Search posts & courses‚Ä¶"
        aria-label="Search"
      />
      <button class="icon-btn" type="submit" aria-label="Search">üîé</button>
    </form>

    <!-- Mobile overlay panel (header ·Ä°·Äï·Äº·ÄÑ·Ä∫) -->
    <nav id="navLinks" class="mobile-panel" aria-label="Mobile Navigation">
      <a class="nav-link" href="#/">Home</a>
      <a class="nav-link" href="#/courses">Courses</a>

      <a class="nav-link auth-only" href="#/dashboard">Dashboard</a>
      <a class="nav-link auth-only" href="#/certs">Certificates</a>
      <a class="nav-link auth-only" href="#/transcripts">Transcripts</a>
      <!-- <a class="nav-link auth-only" href="#/settings">Settings</a> -->
      <a class="nav-link" href="#/profile">Profile</a>

      <a class="nav-link admin-only" href="#/admin">Admin</a>
      <hr />
      <button id="btnLogin_m" class="btn">Login</button>
      <button id="btnLogout_m" class="btn ghost hidden">Logout</button>
    </nav>

    <!-- ===== App content ===== -->
    <main id="app" class="container"></main>

    <footer class="footer">&copy; <span id="year"></span> PƒÅli Lessons</footer>

    <!-- Auth dialog -->
    <dialog id="authDlg" class="auth-modal">
      <form method="dialog" class="auth-card" id="authForm" novalidate>
        <button
          id="closeAuth"
          class="icon-btn close"
          type="button"
          aria-label="Close"
        >
          √ó
        </button>

        <div class="auth-header">
          <img src="/img/plant.png" alt="logo" />
          <h3>Welcome back</h3>
          <p class="muted">Log in to continue your learning</p>
        </div>

        <div class="tabs">
          <button type="button" class="tab active" data-mode="login">
            Log in
          </button>
          <button type="button" class="tab" data-mode="signup">Sign up</button>
          <button type="button" class="tab" data-mode="forgot">Forgot</button>
        </div>

        <div class="fields">
          <label
            >Email
            <input id="authEmail" type="email" autocomplete="email" required />
          </label>

          <label class="pw"
            >Password
            <input
              id="authPassword"
              type="password"
              autocomplete="current-password"
            />
            <button
              type="button"
              id="togglePw"
              class="icon-btn eye"
              aria-label="Show password"
            >
              üëÅ
            </button>
          </label>
        </div>

        <div class="actions">
          <button id="btnAuthSubmit" class="btn primary" type="submit">
            Continue
          </button>
          <button class="btn ghost" type="button" id="btnAuthCancel">
            Cancel
          </button>
        </div>

        <p id="authError" class="error hidden"></p>
      </form>
    </dialog>

    <dialog id="courseDlg" class="modal">
      <form method="dialog" class="sheet">
        <div class="sheet-head">
          <h3 id="cdTitle" style="margin: 0">Course</h3>
          <button
            class="close"
            aria-label="Close"
            onclick="document.getElementById('courseDlg').close()"
          >
            √ó
          </button>
        </div>

        <div class="sheet-main">
          <div class="media">
            <img id="cdImg" alt="" />
          </div>

          <div class="body">
            <p id="cdDesc" class="desc muted"></p>

            <ul class="meta" style="margin: 0.75rem 0">
              <li id="cdLevel"></li>
              <li id="cdCredits"></li>
              <li id="cdBenefits"></li>
              <li id="cdPrice"></li>
            </ul>
          </div>
        </div>

        <menu>
          <button class="btn ghost" value="cancel">Close</button>
          <button id="cdEnrollBtn" class="btn">Enroll / Buy</button>
        </menu>
      </form>
    </dialog>

    <!-- Buy dialog -->
    <dialog id="buyDlg" class="modal">
      <form method="dialog" class="card">
        <h3 id="buyTitle">Purchase course</h3>
        <div id="paypal-buttons" style="margin-top: 0.75rem"></div>
        <menu
          style="
            margin-top: 1rem;
            display: flex;
            justify-content: flex-end;
            gap: 0.5rem;
          "
        >
          <button class="btn ghost">Close</button>
        </menu>
      </form>
    </dialog>

    <!-- jsPDF (UMD) -->
    <script src="https://cdn.jsdelivr.net/npm/jspdf@2.5.1/dist/jspdf.umd.min.js"></script>
    <script>
      // window.jspdf.jsPDF ·ÄÄ·Ä≠·ÄØ ·Ä°·Äû·ÄØ·Ä∂·Ä∏·Äï·Äº·ÄØ·Äõ·Äô·Äö·Ä∫
      function demoMakePDF() {
        // const { jsPDF } = window.jspdf;
        const doc = new jsPDF("l", "pt", "a4");
        doc.text("Hello from jsPDF (UMD)!", 60, 80);
        doc.save("demo.pdf");
      }
      // demoMakePDF();
    </script>
    <!-- PayPal SDK (replace YOUR_CLIENT_ID) -->
    <script
      src="https://www.paypal.com/sdk/js?client-id=AVpfmQ8DyyatFaAGQ3Jg58XtUt_2cJDr1leqcc_JI8LvKIR2N5WB_yljqCOTTCtvK1hFJ7Q9X0ojXsEC&currency=USD"
      defer
    ></script>
    <script type="module" src="/js/firebase.js"></script>
    <script type="module" src="/js/app.js"></script>
  </body>
</html>
